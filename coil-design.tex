\documentclass[11pt,a4paper]{memoir}
\edef\asydir{\jobname}
\usepackage{thesis-preamble}
\EndPreamble
\begin{document}

\chapter{Electromagnetic actuators}
\chaplabel{coil-design}

\referpaper{The work presented in \secref{magnetcoil-forces,magnetcoil-optimisation} is based on material that has been published as a journal paper~\cite{robertson2012-ietm}.}

\section{Introduction}

The field of electromagnetic actuators spans a large variety of applications.
The oldest of these is the voice-coil loudspeaker, which is an area still undergoing continued refinement.
In the introduction of this thesis, a variety of other electromagnetic devices were discussed including planar and multi--\dof/ actuators (\secref{magnetic-actuators}).
%\textcite{yan2008-ietmx} designed a three \dof/ spherical actuator; their paper cites numerous other works to develop similar devices.
In \chapref{magnet-theory} the theory was summarised for calculated forces between permanent magnets; many of these methods used a modelling technique in which a permanent magnet is represented as a surface current density around the circumference of the magnet.
This theory also covers, therefore, the case where the force between a magnet and a coil is under investigation, provided that the coil being modelled can also be represented as an infinitely thin current density.
This is the case only for `thin' coils consisting of one (or a small number of) windings deep.

The equivalence of the current surface density model for permanent magnets and thin coils means the same approach can be used to model both systems, as seen in the work for calculating the force between two thin coils or magnets \cite{babic2008-ietm,ravaud2010-ietm,robertson2011-ietm} summarised in \secref{cyl-forces}.

The theory discussed in this section is based around an integral expression with an efficient numerical implementation for calculating the axial force between a coaxial cylindrical magnet and a `thick' solenoid that consists of many turns both radially and axially.
This integral expression is compared against a variety of other methods.

The motivation for this study is the optimisation of the geometry of a coil--magnet actuator.
The design of a `sleeve coil actuator' is considered in which a magnet of a certain volume moves inside a fixed coil of a certain impedance, with the objective to optimise the geometric parameters to maximise the peak force of the actuator (although other metrics are also possible).
Only the quasi-static force/displacement characteristics are considered; in other words, any inductance effects caused by the moving magnet are neglected, which could affect the high-frequency behaviour of the device.

In this chapter, a simple electromagnetic actuator is analysed in detail, using detailed coil/force equations that have only recently been available.
A new equation is developed for calculating the force between cylindrical coils and magnets with eccentric displacement.
The analysis herein of a single \dof/ actuator shows that it can be possible to optimise coil size, magnet size, and wire diameter to achieve a given force maximum.
Other cost functions can be used in the design methodology to achieve other metrics, such as linearity \cite{merit2009-ietm}.
Finally, an example of an alternate `dual-coil' electromagnet design is provided, which based on the modelling results is shown to achieve greater forces than the single-coil design, all else being equal.


\section{Geometry}

The system under investigation is shown in \figref{coil-magnet,coil-schem}.
In this study there is no restriction on the size or geometry of the magnet or coil.
To describe the geometry of the magnet--coil configuration, two aspect ratios are defined for the magnet and coil respectively. The `magnet ratio' is given by the ratio between length and radius for the magnet, $\ratioMag=\lengthMag/\oradiusMag$, and the `coil ratio' similarly by the ratio between coil length and inner radius, $\ratioCoil=\lengthCoil/\iradiusCoil$.
The clearance (or gap) between the inner coil and magnet radii is denoted $\cradiusCoil=\iradiusCoil-\oradiusMag$.

\begin{figure}
  \asyinclude{\jobname/coil-magnet}
\caption
[\textsc{3d} sketch of the system composed of a permanent magnet and thick coil.]
{Three-dimensional sketch of the system composed of a permanent magnet (unshaded, left) and thick coil (shaded, right). The magnet can be modelled as an equivalent cylindrical surface current density, and the coil  as a volumetric current density.}
\figlabel{coil-magnet}
\end{figure}

\begin{figure}
  \centering
  \asyinclude{\jobname/coil-schem}
  \medskip
\lofcaption{Schematic of a `sleeve coil' magnetic actuator.}{ This geometry can be described in terms of magnet ratio $\ratioMag=\lengthMag/\oradiusMag$ and coil ratio $\ratioCoil=\lengthCoil/\iradiusCoil$. Circles and crosses represent coil windings out from and into the page, \resp.}
\figlabel{coil-schem}
\end{figure}

The coil may have many turns in both axial and radial directions; denote $\turnsZCoil$ the number of turns axially and $\turnsRCoil$ the number of turns radially. Such a coil will have $\turnsCoil=\turnsZCoil \times \turnsRCoil$ turns in total, and assuming the turns are packed equally in both directions the coil will have a volume current density of $\turnsCoil \currentCoil / \gp{ \lengthCoil \gp{\oradiusCoil-\iradiusCoil} }$, where $\currentCoil$ is the current passing through the coil.

The permanent magnet is assumed to have a sufficiently large coercivity such that its magnetisation strength will not be affected by the magnetic field of the coil.
The permanent magnet is also assumed to be homogeneous with a constant magnetisation strength $\remanence$ in the axial direction only.

\subsection{Thick-coil/magnet axial force methods}
\seclabel{magcoil-theory}

In this section, the theory for calculating the interaction force between the thick coil and permanent magnet (\figref{coil-magnet}) will be discussed.
In the first two force calculation methods, `filament' and `shell', the coil and/or magnet are modelled in terms of discrete elements (such as single-turn or thin coils) for which the interaction forces may be summed through superposition of each combination of elements.
The final method uses a single integral expression to calculate the force, and two formulations and solutions for this integral are discussed.
The shell method and the first integral method were developed as part of the current study; the other two methods in from literature, examined for comparison.

\begin{figure}
  \subbottom[Filament model.]{\asyinclude{\jobname/coil-filament}}\hfil
  \subbottom[Shell model.]{\asyinclude{\jobname/coil-shell}}
  \caption[The filament and shell models.]{
  Schematics of the filament and shell models.
  In the filament model, the magnet and thick coil are modelled with individual current loops.
  In the shell model, the magnet is modelled as a cylindrical surface current density and the thick coil is modelled as a number of individual concentric surface current densities to represent multiple windings in the radial direction.
}
\figlabel{filament-shell}
\end{figure}

\subsubsection{The filament method}
\seclabel{filament-method}

For two circular coaxial loops (i.e., a single turn of a solenoid) carrying currents $\current_1$ and $\current_2$ respectively,
the axial force between them is given by~\cite[\eg,][]{shiri2009-pier}
\begin{dmath}[label=coaxial-filament]
\forceFilament\fn{\radius_1,\radius_2,\dispaxial}=\permVac \current_1 \current_2 \dispaxial \sqrt{\frac{m}{4\radius_1\radius_2}}\gp{\EllipticK{m}-\frac{m/2-1}{m-1}\EllipticE{m}}
\end{dmath}
\begin{dmath}[label=coaxial-filament-aux]
m=\frac{4\radius_1\radius_2}{\gp{\radius_1+\radius_2}^2+\dispaxial^2}
\end{dmath}
where $\radius_1$ and $\radius_2$ are the coil radii and $\dispaxial$ is the axial distance between them. The functions $\EllipticK{m}$ and $\EllipticE{m}$ are the complete first and second elliptic integrals respectively with parameter $m$. These functions can also be referred to with notation $\EllipticK{k}$ and $\EllipticE{k}$ in terms of a modulus $k$, where $m=k^2$.

Using the `filament method', \eqref{coaxial-filament,coaxial-filament-aux} can be used to calculate the force between any arrangement of coaxial solenoids by representing each turn of the solenoid as a separate coil, and summing the forces through superposition for every pair-wise combination of coil interaction forces \cite[\eg,][]{babic2008-ietm,akyel2009-pier}.
\figref{filament-shell} shows such a filament model for the interaction between a thin coil (representing a permanent magnet) and a thick coil.
Using this technique, the total force between them is given by
\begin{dgroup}
\begin{dmath}[label=filamentforce]
{\forceThickCoil}_1 = \Sum{\Sum{\Sum{
    F_f\fn{r\fn{n_r},\oradiusMag,\dispaxial+L\fn{n_m,n_z}}
  }{n_z,1,\turnsZCoil}}{n_r,1,\turnsRCoil}}{n_m,1,\turnsZMag}
\end{dmath},
\begin{dmath}
r\fn{n_r}=\oradiusCoil+\frac{n_r-1}{\turnsRCoil-1}\gp{\oradiusCoil-\iradiusCoil}
\end{dmath},
\begin{dmath}
L\fn{n_m,n_z}=-\frac12\gp{\lengthMag+\lengthCoil}+\frac{n_z-1}{\turnsZCoil-1}\lengthCoil+\frac{n_m-1}{\turnsZMag-1}\lengthMag
\end{dmath},
\end{dgroup}
where $\oradiusMag$ is the magnet radius, $\iradiusCoil$ and $\oradiusCoil$ are the inner and outer coil radii, $\lengthMag$ and $\lengthCoil$ are the magnet and coil lengths, $\dispaxial$ is the axial distance between their centres, $\turnsRCoil$ and $\turnsZCoil$ are the number of turns in the thick coil in the radial and axial direction, and $\turnsZMag$ is the number of turns in the thin coil.
The filament current $\current_1=\current$ is the current in the thick coil.
The arrangement of `turns' used to model the permanent magnet is related to an equivalent surface current density with current per turn of $\current_2={\remanence \lengthMag}/\gp{\turnsZMag \permVac}$ and permanent magnet strength~$\remanence$.
The number of `turns' $\turnsZMag$ used to model the permanent magnet should be chosen to be sufficiently large such that the resultant force converges to a stable value.


\subsubsection{The shell method}

In the `shell method' developed here, a thick solenoid and a magnet may be modelled by representing each radial layer of turns as a separate thin coil with surface current density $1/\turnsRCoil$, the volume current density.
The force between them is calculated by summing the forces through superposition of the forces between each thin coil and the magnet:
\def\m#1{m_{#1}}
\begin{dmath}[label=shellforce]
{\forceThickCoil}_2 = \frac{1}{\turnsRCoil}\Sum{ \forceShell\fn{\oradiusMag,r\fn{n_r},\lengthMag,\lengthCoil,\dispaxial} }{n_r,1,\turnsRCoil}
\end{dmath}
\begin{dmath}
r\fn{n_r}=\iradiusCoil+\frac{n_r-1}{\turnsRCoil-1}\gp{\oradiusCoil-\iradiusCoil}
\end{dmath}
where $\forceShell\fn{\oradiusMag,r,\lengthMag,\lengthCoil,\dispaxial}$ is the force between a permanent magnet and a thin coil, shown previously in \eqref[vref]{simpl4}, in which $J_1=\remanence$ is the strength of the permanent magnet and $J_2=\permVac \turnsZCoil \current/\lengthCoil$, where $\current$ is the current in the coil.

\subsubsection{An integral method}

An integral expression for the force between a solenoid and magnet is derived using the theory of Furlani~\cite{furlani2001-magnetbook}.
Here it has been assumed that the solenoid can be modelled as a volume current density and the permanent magnet is modelled as a surface current density around its circumference.
A solenoid with current volume density~$\magJ$ generates a magnetic field~$\magB$ at a displacement $\distrMag$ given by the integral over the coil volume~$\volCoil$
\begin{dmath}
\magB\fn{\distrMag} = \magconst\Int{\frac{\magJ\fn{\distrCoil}\cross\gp{\distrCoil -
\distrMag}}{\Abs{\distrCoil-\distrMag}^3}}{\diffvolCoil,\volCoil}
\end{dmath},
where $\distrCoil$ is the distance vector to the differential coil volume~$d\diffvolCoil$.
The vector force $\forceVec$ due to that field on a permanent magnet with magnetisation vector $\magM$ is given by the integral over the magnet surface $\surfMag$ with normal vector $\normn$
\begin{dmath}[label=magcoil-force-integral]
\forceVec = \oint_{\surfMag} \gp{\magM\cross\normn}\cross\magB\fn{\distrMag}\,d{\diffsurfMag}
\end{dmath},
where $\distrMag$ is the distance vector to the differential magnet surface $d\diffsurfMag$.
Following the magnetic field expression in polar coordinates shown by Ravaud et al.~\cite{ravaud2010-emwaves} and taking only the axial component of the force results, \eqref{magcoil-force-integral} is written in full as a function of axial displacement $\dispaxial$ as
\begin{dmath}[label=magcoil-integral]
\hspace*{-1cm}{\forceThickCoil}_3\fn{\dispaxial} =
\frac{\remanence\turnsCoil\currentCoil}
     {\lengthCoil\gp{\oradiusCoil-\iradiusCoil}}
  \Int{ \\\null\hspace{3cm}\frac{ \distrMag{1}\distrCoil{1}\gp{\distrCoil{1}-\distrMag{1}}\Cos{\distrCoil{2}-\distrMag{2}} }{ \Abs{\distrCoil-\distrMag}^3 } }
  {\distrMag{2},0,2\pi}
  {\distrMag{3},\dispaxial-\lengthMag/2,z+\lengthMag/2}
  {\distrCoil{1},\iradiusCoil,\oradiusCoil}
  {\distrCoil{2},0,2\pi}
  {\distrCoil{3},-\lengthCoil/2,\lengthCoil/2}
\end{dmath}
where
\begin{dmath}
\Abs{\distrCoil-\distrMag}=
\sqrt{\distrMag{1}^2+\distrCoil{1}^2-2\distrMag{1}\distrCoil{1}\Cos{\distrMag{2}-
                 \distrCoil{2}}+\gp{\distrCoil{3}-\distrMag{3}}^2}
\end{dmath}.
Analytically integrating this equation in variables $\distrMag{2}$, $\distrCoil{2}$, and~$\distrMag{3}$ yields
\begin{dmath}[label=cylforcez]
{\forceThickCoil}_3=
\frac{\remanence\turnsCoil\currentCoil}
     {\lengthCoil\gp{\oradiusCoil-\iradiusCoil}}
\Int{
  \sum_{e_1}^{\{1,-1\}} \!\!\!\gp{e_1 m_6 f_{c_3}}
  }
  {\distrCoil{1},\iradiusCoil,\oradiusCoil}
  {\distrCoil{3},-\lengthCoil/2,\lengthCoil/2}
\end{dmath},
where
\begin{dmath}
f_{c_3}=\gp{1-\half m_5}\EllipticK{m_5}-\EllipticE{m_5}
\end{dmath},
\begin{align}
m_5&=\frac{4\oradiusMag\distrCoil{1}}{m_6^2}, &
m_6^2 &= \gp{\oradiusMag+\distrCoil{1}}^2+\gp{\dispaxial+\half e_1 \lengthMag-\distrCoil{3}}^2 .
\eqlabel{cylforcez-auxiii}
\end{align}
Note that $\distrCoil{3}$ and $\distrCoil{1}$ in \eqref{cylforcez-auxiii} are variables of integration.

Computing \eqref{cylforcez} using numerical integration is an efficient means to calculate the axial force between a coaxial magnet and solenoid.
This method is here referred to as the `integral' method.

\subsubsection{The integral method of Babic et al.}

Babic et al.~\cite{babic2011-ietm} presented a different solution for the integral of \eqref{magcoil-integral}.
Their solution consists of an entirely analytical component with one separate term requiring a single numerical integration.
Corrected for a typographical error \parencite{babic2012-ietm-corr} and rewritten, their expression is shown in \eqref{babicforce} and herein is refered to as the `Babic' method.
The sign of the result has been reversed over the original expression to ensure consistency with the results presented in this paper.
With parameters are as described earlier in this section, the force exerted on a permanent magnet by a thick coil using Babic's method, ${\forceThickCoil}_4$,~is
\def\ti{t}
\def\ri{\rho}
\def\HeumanLambda{\Lambda_0}
\def\a{\xi_}
\def\m#1{m_#1}
\begin{dmath}[label=babicforce]
{\forceThickCoil}_4 = \frac{\turnsCoil \currentCoil \remanence \oradiusMag^3}{6 \lengthCoil \gp{\oradiusCoil-\iradiusCoil}} \sum_{e_1,e_2,e_3}^{\{1,-1\}^3} \gp{e_1 e_2 e_3 \,\ti \,f_{c_4}}
\end{dmath}
where
\begin{dgroup*}
\begin{dmath*}
f_{c_4} = \psi_1\sqrt{\ri \m1}
   + \frac{\pi\psi_2}{2\Abs{\ti}}
   + 6 \psi_3
\end{dmath*},
\begin{dmath*}[compact]
\ti =\frac{\dispaxial+\half e_1 \lengthMag+\half e_2 \lengthCoil}{\oradiusMag}
,\qquad
\ri = \frac{\iradiusCoil+\oradiusCoil+e_3 \gp{\oradiusCoil-\iradiusCoil}}{2\oradiusMag}
\end{dmath*},
\begin{dmath*}[compact]
\m1 = \frac{4\ri}{\gp{\ri+1}^2+\ti^2},\quad
\m2 = \sqrt{\ti^2+1}
\end{dmath*},
\begin{dmath*}
\psi_1 =
    \EllipticK{\m1}\gp
     {
      \frac{\m2+2}{\m2+1}\gp{\ti^2-2}
      +\ri^2+\ri+2-\frac{2}{\ri+1}
     }
    - \frac{4\ri}{\m1} \EllipticE{\m1}
\end{dmath*}
\begin{dmath*}
\psi_2 =
    \ri \Sign{ \ri-1 } \gp{ \ri^2-3 } \gp{ \HeumanLambda\fn[2]{\Abs{\a1},\m1} - 1 }
    + \\\m2\gp{\ti^2-2}\gp[3]
      {
        \HeumanLambda\fn[2]{\Abs{\a2},\m1}-1
        +\Sign{\ri-\m2}\gp{\HeumanLambda\fn[2]{\Abs{\a3},\m1}-1}
      }
\end{dmath*}
\begin{dmath*}
\psi_3 = \Integrate{\ArcSinh{\frac{\ri+\Cos{2\varphi}}{\sqrt{\Sin{2\varphi}^2+\ti^2}}}}{\varphi,0,\pi/2}
\end{dmath*},
\begin{dmath*}[compact]
\a1 = \ArcSin{\frac{\ri-1}{\ri+1}\sqrt{\frac{1}{1-\m1}}},\qquad
\a2 = \ArcSin{\frac{\ti}{\m2+1}}
\end{dmath*},
\begin{dmath*}
\a3 = \ArcSin{\frac{\ti}{\m2+1}\sqrt{\frac{1}{1-\m1}}}
\end{dmath*},
\end{dgroup*}
where $\HeumanLambda$ is the Heuman Lambda function defined by
\begin{dmath}
\HeumanLambda\fn{\phi,m} =
  \frac{2}{\pi}
  \gp{\strut\EllipticF{\phi,1-m}\gp{\EllipticE{m}-\EllipticK{m}}+\EllipticE{\phi,1-m} \EllipticK{m}}
\end{dmath},
and $\Sign{\cdot}$ represents the sign function
\begin{equation}
\Sign{x} =
\begin{cases}
-1 & x<0 ,\\
\hphantom{+}0 &  x=0,\\
+1 & x>0.
\end{cases}
\end{equation}
When implementing \eqref{babicforce}, note that $t f_{c_4}=0$ when $t=0$ and the inner term $f_{c_4}$ does not need to be evaluated as it otherwise contains a numerical singularity.

\subsubsection{Comparison of these methods}

The filament model with a single radial turn ($\turnsRCoil=1$) can be used to verify the thin-coil magnet force, and an initial verification of the integral solution can be performed by comparing the thin-coil results for a thick-coil with coil thickness equal to the wire diameter.
Force versus displacement calculations are performed with these three techniques (\eqref{filamentforce,shellforce,cylforcez}) using the physical parameters defined in \tabref{magcoil-thin-compare-param}; results of these calculations are shown in \figref{magcoil-thin-compare} and it can be see that the three models produce comparable results.
The results due to the filament model have a small discrepancy around the trough of the curve due to the discretisation of the magnet that this technique requires.


\begin{figure}
\centering
\psfragfig{magcode/examples/fig/thin-compare}
\lofcaption{Results of three methods for calculating the force versus axial displacement between a coaxial thin coil and magnet.}{
For the filament and shell methods, the thin coil is modelled as having zero thickness.
The thick coil force equation models the coil as a volumetric current density in this case with a radial thickness equal to the wire diameter.}
\figlabel{magcoil-thin-compare}
\end{figure}

\begin{table}
\caption
  [Magnet--coil parameters for simulation of thin-coil forces.]
  {
   Magnet--coil parameters used for simulation of thin-coil forces (\figref{magcoil-thin-compare}).
   Coil thickness is used for the thick coil equation only.
  }
\tablabel{magcoil-thin-compare-param}
\centering
\begin{tabular}{l>{$}c<{$}l}
\toprule
Magnet radius & \oradiusMag & \SI{9}{mm} \\
Magnet length & \lengthMag & \SI{10}{mm} \\
Magnet `turns' & \turnsZMag & \num{100} \\
Magnet remanence & \remanence & \SI{1}{T} \\
Coil inner radius & \iradiusCoil & \SI{10}{mm} \\
Coil thickness & \oradiusCoil-\iradiusCoil & \SI{0.5}{mm} \\
Coil length & \lengthCoil & \SI{20}{mm} \\
Coil turns & \turnsZCoil & \num{40} \\
Coil current & \currentCoil & \SI{1}{A} \\
\bottomrule
\end{tabular}
\end{table}

Having verified the filament, shell and integral methods for calculating the force between a thin coil and a magnet, the next step is to perform a similar comparison for calculating the force for a thick coil instead.
A similar set of calculations were performed, including Babic et al.'s integral approach (\eqref{babicforce}), using the same set of parameters as in \tabref{magcoil-thin-compare-param} except with a thick coil instead with a thickness $\oradiusCoil-\iradiusCoil=\SI{5}{mm}$ with $\turnsZCoil=\num{20}$ turns in the axial direction and $\turnsRCoil=\num{5}$ turns in the radial direction.
The force versus displacement results for the thick coil/magnet calculations are shown in \figref{magcoil-thickthin-compare}, and again the results of the four techniques are in close agreement.
In particular, the equation by Babic et al.~\cite{babic2011-ietm} produces results consistent with the integral expression developed in this chapter.
The discrepancy due to the discretisation of the filament model is larger here than for the results of \figref{magcoil-thin-compare}.

\begin{figure}
\centering
\psfragfig{magcode/examples/fig/thickthin-compare}
\caption{Results of four methods for calculating the force versus axial displacement between a coaxial thick coil and magnet.}
\figlabel{magcoil-thickthin-compare}
\end{figure}

The four methods compared in \figref{magcoil-thickthin-compare} all use different algorithms, and their execution speed varies significantly as a result.
The shell method is more efficient than the filament method, since its execution time is linear with the number of radial layers of turns $\turnsRCoil$ due to a single summation term.
The filament method is the slowest to execute of the four methods, as it has computation time proportional to $\turnsZCoil \times \turnsRCoil\times \turnsZMag$, which is approximately cubic with the number of turns in total.

Of the integral and Babic methods (\eqref{cylforcez,babicforce} \resp), for calculations requiring less stringent accuracy (say, to four significant figures precision) it is more efficient to use the integral method due to the mathematical complexity of the latter, despite it requiring a lesser amount of numerical integration.
This is illustrated in \figref{magcoil-prec-timing}, in which it can be seen that increasing the integration precision when performing calculations using Mathematica causes the time for numerical evaluation of the integral to increase exponentially, whereas the `Babic' method has a constant execution speed as its single term requiring numerical integration is only a small component of the overall equation.
Nonetheless, as shown in the numerical results (\tabref{prec-results}), the integral solution will generally produce results to a sufficient level of accuracy even with low integration accuracy thresholds and therefore may be the preferred solution in some cases, such as for optimisation studies.

In contrast, the shell method is much more efficient than either of the integral methods; it executes faster than the Babic method by up to two orders of magnitude.
In comparison to the \SI{40}{ms} time shown in \figref{magcoil-prec-timing} for the Babic method, the shell method executes in around \SI{0.26}{ms} per radial turn with an output result differing by \SI{0.0125}{\%} from the most accurate of \tabref{prec-results}.
The large improvement in execution speed of the shell method is due to the mathematical simplicity of its solution which does not require numerical integration.
Despite the presence of small variations in the results due to the discretisation of the algorithm, this method will be significantly faster and achieve comparable results than the other techniques discussed in this section for analysing thick coils with a number of radial turns up to around $10^2$.

\begin{figure}
\centering
\psfragfig{magcode/examples/fig/prec-timing}
\lofcaption{Illustrative computation times for evaluating the results shown in \tabref{prec-results}.}{ Integration precision refers to the minimum number of correct significant figures.}
\figlabel{magcoil-prec-timing}
\end{figure}

\begin{table}
\def\G{\color[gray]{0.7}}
\lofcaption{Numerical output with increasing integration precision.}{ Gray digits indicate inaccuracy in the result after rounding to that many significant figures.}
\tablabel{prec-results}
\centering
\fontfamily{pplx}\selectfont
\begin{tabular}{@{}rll@{}}
\toprule
& \multicolumn{2}{c}{Method} \\
\cmidrule{2-3}
Precision & Babic, \eqref{babicforce} & Integral, \eqref{cylforcez} \\
\midrule
1  & 2.45444\G07879895993  & 2.\G4744006907978187 \\
2  & 2.45444\G07879895993  & 2.45\G48594892044457 \\
3  & 2.45444\G07879895993  & 2.45\G48594892044457 \\
4  & 2.45444383\G06124783  & 2.45443\G92729491915 \\
5  & 2.45444383\G06124783  & 2.45444\G10458278520 \\
6  & 2.454443829\G6675000  & 2.4544437\G864466280 \\
7  & 2.45444383009\G39190  & 2.4544438\G175568843 \\
8  & 2.4544438300903\G315  & 2.454443829\G9997147 \\
9  & 2.4544438300903\G315  & 2.4544438301\G061358 \\
10 & 2.454443830090323\G0  & 2.454443830090\G4050 \\
\bottomrule
\end{tabular}
\end{table}

While the computational times given in this section are specific to the platform used to perform the calculations, their relative differences should be comparable across different computers and numerical implementations.



%%%%%%%%%%%%%%%%%

\subsection{Axial force with eccentric displacement}

The work in the previous sections considered only coaxial forces between a coil and magnet.
Certain electromagnetic designs will require the consideration of the effect of eccentric displacement; that is, displacement in the radial direction.
An example of such a design is `pancake coils' \cite{akyel2003-intermag,shiri2009-pier}, which are thin axially but have a large radial face; eccentric displacement is not constrained and the sensitivity of eccentricity on axial force may be of interest.

The theory for coaxial magnet/coil forces (\eqref{magcoil-integral}) can be extended for the non-coaxial case.
Under eccentric displacement in the radial direction, the limits of integration must be expressed in a translated coordinate system (see \figref{int-offset}) and the original integral must be modified to include additional terms to take this into account.

\begin{figure}
\centering
\asyinclude{\jobname/circle-offset}
\caption
[Region of integration for a radially displaced magnet.]
{Region of integration for a radially displaced magnet, shifted by $\smash{\matr{}{\xi;\eta}}$ from the original coordinate system.}
\figlabel{int-offset}
\end{figure}

In order to incorporate eccentric displacement into the integral, the terms for $\distrMag{1}$
and $\distrMag{2}$ must be expressed as functions of the terms $\distrMag{1}'$
and $\distrMag{2}'$.
The following transformation can be used to perform this:
\begin{align}
\distrMag{1} &= \sqrt{\distcMag{1}^2+\distcMag{2}^2} &
\distcMag{1} &= \distcMag{1}' - \xi                 &
\distcMag{1}' &= \distrMag{1}'\Cos{\distrMag{2}'}
\\
\distrMag{2} &= \ArcTan{\distcMag{2},\distcMag{1}}  &
\distcMag{2} &= \distcMag{2}' - \eta               &
\distcMag{2}' &= \distrMag{1}'\Sin{\distrMag{2}'}
\end{align}
Due to the additional complexity introduced by this transformation, the original integral can no longer be easily solved analytically with respect to $\distrMag{2}'$.
The variable $\distrMag{1}'$ is not an integration term and therefore $\distrMag{1}'=\radiusMag$.
Accordingly, after rederiving the integral, the axial force due to both axial and radial displacement is now given by
\begin{dmath}[label=cylforcez-ecc]
f_{c_4}=
\frac{\turnsCoil \currentCoil \remanence}{\pi\lengthCoil\gp{\oradiusCoil-\iradiusCoil}}
\Int{
  \sum_{e_1}^{\{1,-1\}} \!\!\! \gp{e_1 \m2 f_{c_4} }
  }
  {\distrMag{2}',0,\pi}
  {\distrCoil{1},\iradiusCoil,\oradiusCoil}
  {\distrCoil{3},-\lengthCoil/2,\lengthCoil/2}
\end{dmath},
where the intermediate term is
\def\P{\distrMag{2}}
\begin{dmath}
f_z=\gp{1-\frac{\m1}{2}}
      \EllipticK{\m1}-\EllipticE{\m1}
\end{dmath},
with parameters
\begin{align}
\m1&=\frac{4 \distrMag{1} \distrCoil{1}}{\m2^2}, &
\m2^2 &= \gp{\distrMag{1}+\distrCoil{1}}^2+\gp{\dispaxial+\half e_1\lengthMag-\distrCoil{3}}^2 .
\end{align}

Due to the additional numerical integral that must be evaluated when using \eqref{cylforcez-ecc}, it is approximately an order of magnitude slower to calculate than \eqref{cylforcez}.
The expression is slightly optimised for efficiency; from $0$ to $2\pi$ around $\distrMag{2}'$ the integral is symmetric so only the first half is calculated; this approximately halves the execution time of numerical integration.

The filament method can again be used to verify \eqref{cylforcez-ecc}.
Kim et al.~\cite{kim1996-ietm} presented an expression for calculating the filamentary force between two non-coaxial circular coils; their equations were corrected for typographical errors and reprinted by Hull and Cansiz~\cite{hull1999-japplphys}.
However, it is believed that their work is incorrect as the results produced from Kim et al.'s equation are not consistent with either the coaxial filament force  (\eqref{coaxial-filament}) nor the recently published generalisation by Babic and Aykel~\cite{babic2011-ietm-incl-coil} for calculating the force between noncoaxial and inclined circular coils.

The non-coaxial filamentary coil force in the axial direction for eccentric (radial) displacement $\dispradial$ is taken from the third special case given by Babic and Aykel~\cite{babic2011-ietm-incl-coil}:
\begin{dmath}[label=eccfilament]
\forceFilament\fn{\radius_1,\radius_2,\dispaxial,\dispradial} = \frac{\permVac \dispaxial \radius_2 \current_1 \current_2}{4\pi}
\Integrate{
  \frac{m_2}{v^2}
  \gp[2]{ y\Cos{t}-x\Sin{t} }\times
  \gp{ 2\EllipticK{m} - \EllipticE{m}\frac{2-m}{1-m} }
}{t,0,2\pi}
\end{dmath},
where
\begin{gather}
x = e - r_2\Sin{t} ,\quad  y = r_2\Cos{t} ,\quad
v = \sqrt{x^2+y^2},
\notag\\
m = 4 \radius_1 v m_2^2 , \quad
m_2 = \gp{\gp{\radius_1+v}^2+\dispaxial^2}^{-1/2}.
\end{gather}
%and the radial (or eccentric) force given by
%\begin{dmath}[label=eccfilamentecc]
%F_e\fn{r_1,r_2,z,e} = \frac{\permVac r_2 I_1 I_2}{4\pi}
%\Integrate{
%  m_2\Sin{t}
%  \times
%  \gp{ -2\EllipticK{m} + \EllipticE{m}\frac{2-m\gp{r_1/V+1}}{1-m} }
%}{t,0,2\pi}
%\end{dmath}.
%$F_e$ acts in the direction of eccentric displacement.
\Eqref{eccfilament} can be used with the filament method (as in \eqref{filamentforce}) to calculate thick-coil magnet forces, but this is only useful as a verification as the filament method using a numerical integral is extremely slow to execute (around three orders of magnitude slower than the integral solution of \eqref{cylforcez-ecc}).
Such a comparison is shown in \Figref{magcoil-ecc-compare}, which has system parameters as shown in \Tabref{magcoil-thin-compare-param}, aside from a larger inner coil radius of \SI{11.5}{mm} and an eccentric displacement of \SI{1.5}{mm}.
This figure shows that the integral method proposed here gives results in agreement with the filament method.

Eccentricity acts to increase the axial force of a coil/magnet system as the magnetic material comes closer to the region of greater magnetic field strength due to the solenoid (\figref{magcoil-ecc-vary}).
This result indicates that decreasing the airgap between the coil and magnet as much as possible is desirable to maximise the forces obtained for a given input current.

\begin{figure}
\begin{wide}
\begin{subfigure}
\hspace*{-1.5cm}%
\psfragfig{magcode/examples/fig/ecc-compare}
\lofcaption{
  Comparison of the filament and integral methods for calculating eccentric thick coil--magnet forces.}{ Due to discretisation in the filament method the results vary near their extremum.
  \figlabel{magcoil-ecc-compare}
}
\end{subfigure}\hfil\hfil
\begin{subfigure}
\hspace*{-1.5cm}%
\psfragfig{magcode/examples/fig/ecc-vary}
\caption{
  Example thick coil forces in the axial direction versus displacement for increasing eccentricities from \SIrange{1}{2.5}{mm} indicated by the arrow. Zero eccentricity is shown dashed.
  \figlabel{magcoil-ecc-vary}
}
\end{subfigure}
\end{wide}
\caption{Two examples of eccentric thick coil magnet forces calculations.}
\end{figure}




\section{Optimisation of a sleeve coil magnetic actuator}
\seclabel{magnetcoil-optimisation}

In the previous section, methods were presented for calculating coil forces with arbitrary examples used for verification.
These equations can be used for optimisation of a magnetic actuator; for example, to choose geometric parameters for an inertial shaker to maximise the peak force or to maximise the stroke length.
In this section, a common `sleeve coil' configuration is investigated in which a cylindrical magnet moves axially within a hollow coil, such that the inner coil radius is greater than the magnet radius; $\iradiusCoil>\oradiusMag$.
A schematic of this system is shown in \figref{coil-schem}.

\subsubsection{Relationship between coil impedance and outer diameter}
\seclabel{magcoil-radii}

When attempting to optimise the force output of a coil/magnet design, it is important to carefully consider the parameters to be varied so that comparisons between different cases are fair.
In the theory developed in \secref{magcoil-theory}, the force is calculated using coils of a given current density and coil thickness.
When designing a coil, however, it is instead more applicable to fix the coil resistance and wire thickness and calculate the number of turns and outer coil radius from these values.
In this way, comparisons between different geometries will be indicative of force for some fixed electrical input power as each coil variation will draw the same amount of current for a given driving voltage.

The resistance of the coil $\resistanceCoil$ directly infers the length of the wire winding,~$\lengthWire$, through the relation
\begin{dmath}
\lengthWire = \resistanceCoil \areaWire / \resistivity,
\end{dmath}
for wire of cross sectional area $\areaWire$ (assumed here as having circular cross section $\areaWire=\pi \gp{\half\diamWire}^2$), and resistivity~$\resistivity$.

The fixed parameters of the coil are driving voltage, resistance, wire thickness and material, which in turn fix the total length of wire.
Given a total length of wire, it is possible to derive a relation between the coil length, $\lengthCoil$, and the coil radii, $\iradiusCoil$ and $\oradiusCoil$.
Assuming that each turn of wire sits directly above or adjacent to its neighbours, an approximate expression for the total wire length is given by
\begin{dmath}[label=coil-lengthwire,compact]
\lengthWire = \turnsZCoil\Sum{2\pi\gp[2]{\iradiusCoil+\diamWire\gp{n+\half}}}{n,0,\turnsRCoil-1}
  = 2\pi \turnsRCoil \turnsZCoil \gp{\iradiusCoil+\half\turnsRCoil\diamWire},
\end{dmath}
where $\turnsRCoil=\gp{\oradiusCoil-\iradiusCoil}/\diamWire$ and $\turnsZCoil=\lengthCoil/\diamWire$ are the number of turns in the axial and radial directions respectively.
While this relationship does not model any wire coating or the packing effect of how tightly-wound coils will sit,
\note{
  Taking into account of the packing factor will reduce the outer radius by around 10\% of the thickness of the coil \cite{yan2008-ietmx}.
}
this equation is simple and allows some conservatism in the quality of the construction of the electromagnet.

Therefore, an expression for the outer radius of the coil for a coil of fixed inner radius and fixed total wire length is
\begin{dmath}[label=coil-outerdiam]
  \oradiusCoil = \sqrt{\frac{\lengthWire\diamWire^2}{\pi \lengthCoil}+\iradiusCoil^2}
\end{dmath}.

\subsubsection{Notation}

From \secref{magcoil-theory}, the axial force versus displacement for a thick-coil/magnet system can be expressed as a function of its gross geometric parameters (defined in \figref{coil-magnet}) as
\begin{dmath}[label=magcoil-ffn1]
\forceThickCoil\fn{\remanence,\currentCoil,\turnsZCoil,\turnsRCoil,\oradiusMag,\lengthMag,\iradiusCoil,\oradiusCoil,\lengthCoil|\dispaxial}
\end{dmath},
with electromagnetic parameters ($\remanence$, $\currentCoil$, $\turnsZCoil$, $\turnsRCoil$) defined previously and $\forceThickCoil$ calculated with any of the filament, shell, or integral methods (\eqref{filamentforce,shellforce,cylforcez,babicforce}, \resp).

The magnet radius $\oradiusMag$ can be expressed in terms of the magnet ratio $\ratioMag$ and magnet volume $\volMag$ with
\begin{align}
\oradiusMag&=\gp{\frac{\volMag}{\pi \ratioMag}}^{1/3},
\end{align}
from which the magnet length $\lengthMag=\ratioMag\oradiusMag$, coil inner radius $\iradiusCoil=\oradiusMag+\cradiusCoil$, and coil length $\lengthCoil=\ratioCoil\iradiusCoil$ are inferred directly from the geometric ratios and clearance between the coil and magnet $\cradiusCoil$.

As discussed in \secref{magcoil-radii}, the outer coil radius $\oradiusCoil$ and the coil turns $\turnsZCoil$ and $\turnsRCoil$ can be calculated from the coil resistance $\resistanceCoil$, wire diameter $\diamWire$ and wire resistivity~$\resistivity$.
Therefore, the force function of \eqref{magcoil-ffn1} can be expressed in terms of the following different set of parameters which are more useful for design optimisation:
\begin{dmath}[label=magcoil-ffn2]
\forceThickCoil\fn{\remanence,\currentCoil,\resistivity,\volMag,\resistanceCoil,\diamWire,\ratioMag,\ratioCoil,\cradiusCoil|\dispaxial}
\end{dmath}.
Of these parameters, the magnet strength is set to be $\remanence=\SI{1}{T}$, the radial clearance is fixed at $\cradiusCoil=\iradiusCoil-\oradiusMag=\SI{0.5}{mm}$, and the resistivity of copper of $\resistivity=\SI{1.7e-8}{\ohm.m}$ is used.
Initially the normalised force per unit current $\fnorm$ is considered, which is calculated by evaluating the force for a current of $\currentCoil=\SI{1}{A}$.
Removing these fixed parameters from \eqref{magcoil-ffn2} produces
\begin{dmath}[label=magcoil-ffn3]
\fnorm\fn{\volMag,\resistanceCoil,\diamWire,\ratioMag,\ratioCoil|\dispaxial}
\end{dmath}.

In the sections to come, the coil-magnet force $F_z$ will be discussed as a function of magnet volume $\volMag$, coil resistance $\resistanceCoil$, wire diameter $\diamWire$, magnet ratio $\ratioMag$, coil ratio $\ratioCoil$, and axial displacement $\dispaxial$.
The goal of the analysis will be to derive optimum values for certain of these parameters.

At the outset it is assumed that increasing the magnet volume $\volMag$ will result in greater forces since there will be a greater amount of magnetic energy in the system; this is not then a parameter to be varied but instead to be selected as necessary.

\subsubsection{Optimisation of magnet and coil geometry}
\seclabel{sleeve}

To perform the optimisation of magnet and coil geometries, the shell method, \eqref{shellforce}, is used to calculate the force as a function of displacement with varying magnet and coil ratios.

For sake of example, a wire diameter $\diamWire=\SI{1}{mm}$ was selected to produce the initial results; wire diameter is later varied in \secref{wire-diam}.
The volume of magnetic material is held constant at $\volMag=\gp{\SI{20}{mm}}^3$ and the coil impedance at $\resistanceCoil=\SI{4}{\ohm}$.
Therefore the normalised force per unit current is calculated for this case as
\begin{dmath}[label=magcoil-ffn4]
\fnorm\fn{\ratioMag,\ratioCoil|\dispaxial}=\fnorm\fn{\gp{\SI{20}{mm}}^3,\SI{4}{\ohm},\SI{1}{mm},\ratioMag,\ratioCoil|\dispaxial}
\end{dmath}.

The effects on the force--displacement characteristic of \eqref{magcoil-ffn4} of varying the magnet ratio~$\ratioMag$ and coil ratio~$\ratioCoil$ independently are shown respectively in \figref{magcoil-ratios}.
For each it can be seen that the peak force and the shape of the curve varies significantly as the geometry of the magnet and coil changes.
It can also be seen that an optimal $\ratioMag$ and $\ratioCoil$ could be chosen to satisfy a particular cost function such as peak force, integral of force over displacement, displacement over which at least 95\% of the peak force is achieved, linearity over a certain displacement range, and so on, according to the requirements of the actuator being designed.
For simplicity, in the examples to follow the metric to be maximised is chosen to be the peak force but the methodology for design optimisation holds regardless of the cost function.

\begin{figure}
\begin{wide}
\subbottom[Varying magnet ratio $\ratioMag$ for a fixed coil ratio $\ratioCoil=1$.]{\minibox[c]{\psfragfig{magcode/examples/fig/magcoil-magratio}\\[0.5ex] \qquad\footnotesize Displacement, mm\\[1.5ex]}}\quad
\subbottom[Varying coil ratio $\ratioCoil$ for a fixed magnet ratio $\ratioMag=2$.]{\minibox{\psfragfig{magcode/examples/fig/magcoil-coilratio}}}
\end{wide}
\caption
[Normalised force versus displacement calculations for two cases.]
{Normalised force $\fnorm$ versus displacement calculations for two cases.}
\figlabel{magcoil-ratios}
\end{figure}

The magnet and coil ratios $\ratioMag$ and $\ratioCoil$ were considered over a range from \numrange{0.1}{10} and the normalised peak force over displacement calculated as a function of these two varying parameters.
The normalised peak force was calculated as
\begin{dmath}[label=magcoil-peakforce1]
\fnpeak\fn{\volMag,\resistanceCoil,\diamWire,\ratioMag,\ratioCoil} = \max_{\dispaxial} \biggl\{\fnorm\fn{\volMag,\resistanceCoil,\diamWire,\ratioMag,\ratioCoil|\dispaxial}\biggr\}
\end{dmath},
where magnet volume $\volMag$, coil resistance $\resistanceCoil$, and wire diameter $\diamWire$ were fixed as described earlier.

\Figref{magcoil-fmax-ratios} shows an example of the normalised peak force evaluated with \eqref{magcoil-peakforce1} over a discretisation of the magnet and coil ratio ranges.
This surface can be seen to be concave, and therefore a single value for $\ratioMag$ and $\ratioCoil$ can be chosen to maximise the normalised peak force for a given magnet volume, coil impedance, and wire diameter.

\begin{figure}
\centering
\psfragfig{magcode/examples/fig/magratio-maxforce}\hspace*{5mm}
\raisebox{11.5mm}{\psfragfig{magcode/examples/fig/magratio-maxforce-cb}}
\caption
[Peak normalised force as magnet and coil ratios and are varied.]
{Peak normalised force $\fnpeak$ as magnet and coil ratios $\ratioMag$ and $\ratioCoil$ are varied over a \num{20x20} discrete grid for a specific wire diameter, coil impedance, and magnet volume. Maximum normalised peak force is indicated with a star.}
\figlabel{magcoil-fmax-ratios}
\end{figure}

\subsubsection{Optimisation of wire diameter}
\seclabel{wire-diam}

In \secref{sleeve}, the peak force results were normalised against coil current and the effect of wire diameter has not been taken into account.
However, the wire diameter is a particularly important parameter, as it directly infers the length of wire to be used but more importantly restricts the current carrying capacity of the coil.
A larger diameter wire will produce a lower resistance per unit length, and hence for a given input impedance a longer wire length in total.
Depending on the geometry of the coil, having a longer wire length could cause the coil to become unnecessarily thick, moving magnetic energy away from where it is required, which is as close as possible to the permanent magnet.
Having shown a method by which an optimal magnet and coil geometry can be chosen (\eg, as shown in \figref{magcoil-fmax-ratios}) it is now possible to introduce the wire diameter as a variable parameter, which will allow an optimal wire diameter to be chosen.

First consider the case of optimising the normalised peak force per unit of current over magnet and coil ratios and a range of wire diameters using the equation
\begin{dmath}[label=magcoil-maxforce]
\fnmax\fn{\volMag,\resistanceCoil,\diamWire} = \max_{\ratioMag,\ratioCoil} \biggl\{\fnpeak\fn{\volMag,\resistanceCoil,\diamWire,\ratioMag,\ratioCoil}\biggr\}
\end{dmath}.
Rather than gridding the parameter space for $\ratioMag$ and $\ratioCoil$ into discrete values as in \figref{magcoil-fmax-ratios}, this optimisation was performed using a two-dimensional local maximum search function (Mathematica's \texttt{FindMaximum}).
The results from evaluating \eqref{magcoil-maxforce} as a function of wire diameter over a range of coil resistances is shown in \figref{magcoil-ratiomax-norm}.
As the wire diameter increases, the resistance per unit length decreases and a larger coil is required; past a certain point, this decreases the amount of force per unit current that the coil can achieve.

\begin{figure}
\begin{wide}
\begin{subfigure}
\hspace*{-1.5cm}
\psfragfig{magcode/examples/fig/magcoil-ratiomax-norm}
\caption{Maximum normalised force per ampere of current.\figlabel{magcoil-ratiomax-norm}}
\end{subfigure}\hfil
\begin{subfigure}
\psfragfig{magcode/examples/fig/magcoil-ratiomax}
\caption{Maximum peak force $\fmax$ versus wire diameter with and without a safety factor.\figlabel{magcoil-ratiomax}
}
\end{subfigure}
\end{wide}
\lofcaption{
  Maximum peak and normalised force per ampere of current, optimised by magnet and coil geometry as a function of wire diameter.
}{
  Results are shown for three values of coil impedance while the magnet volume is fixed at $\volMag=(\SI{20}{mm})^3$.
Solid, labelled lines have a safety factor of 100\%; dashed lines represent the same curves using a \SI{20}{\%} safety factor on allowable maximum current; they exhibit the same shape with a proportionally lower peak amplitude.
}
\figlabel{magcoil-ratiomax-comb}
\end{figure}

\Figref{magcoil-ratiomax-norm} is noisy at small wire diameters due to quantisation errors in calculating the number of turns of the coil.
When calculating the outer radius of the coil with \eqref{coil-outerdiam}, a non-integer number of radial turns is required to achieve an exact wire length, and discrepancies result as the number of radial turns in quantised.
These errors are greater at lower wire diameters as each individual coil turn contributes a greater proportional of the total coil resistance.

\subsection{Consideration of maximum current rating}

As the wire diameter increases, the amount of force per unit of current decreases.
However, as the wire diameter increases the maximum current rating increases as well; larger wire diameters can be driven with a larger input voltage.

There is a general relationship relating wire diameter and its maximum current rating \cite{sams1986-elec-tables}, denoted $\currmax$ and shown in \figref{magcoil-maxcurr}; note that although this relationship is conservative it does not take into account factors such as thermal loading due to tightly-wound coils or high-frequency current oscillations.
As the maximum current rating data is applicable only for bare wire, a safety factor must be used for coils with many turns; a value of \SI{20}{\%} is chosen for illustrative purposes here.
Using this data, an estimate of the maximum peak force (after optimising the magnet and coil geometries individually) can be calculated for a range of wire diameters scaled according to their maximum current rating.

\begin{figure}
\centering
\psfragfig{magcode/examples/fig/magcoil-maxcurr}
\caption[Typical values for maximum current rating for copper wire of varying diameter.]{Typical values for maximum current rating for copper wire of varying diameter \cite[adapted]{sams1986-elec-tables}, and the same data with a \SI{20}{\%} safety factor (dashed).}
\figlabel{magcoil-maxcurr}
\end{figure}

An upper estimate of the maximum force obtainable with a coil of certain wire diameter is found by multiplying the normalised maximum peak force by the maximum current rating, $\fmax\fn{\volMag,\resistanceCoil,\diamWire,\safetyFactor}=\fnmax\fn{\volMag,\resistanceCoil,\diamWire}\times\currmax\times \safetyFactor$, using a safety factor~$\safetyFactor$ to account for unmodelled thermal effects.
This produces the curves of maximum peak force shown in \figref{magcoil-ratiomax}, which each show a global maximum against wire diameter, although as the wire diameter increases the achievable peak force remains largely flat for wire diameters above the optimum values.

It is important to consider that these results can only be considered an upper limit on the possible forces achievable as the maximum operating temperature will be greatly limited due to thermal effects.
The shape of these curves, and hence the value of suitable wire diameter, is not affected by the safety factor chosen.
Primarily, the curves in \figref{magcoil-ratiomax} indicate that increasing the wire diameter is not effective past a certain point for the chosen constraints, being a maximum diameter of around \SIrange{1}{1.5}{mm}.

\subsection{Trends in the optimisation results}

It is interesting to consider the parameters chosen for the optimal values of magnet and coil ratios (\figref{magcoil-ratiomax-ratios}).
As discussed earlier, due to quantisation errors in the calculation of radial turns, the optimal magnet and coil ratios are not smooth with wire diameter.
Secondly, the accuracy of the numerical methods used to calcute these optimal values introduces numerical error into the results, and improving this accuracy is prohibitive in terms of calculation time.

Despite this, two broad characteristics can be seen.
The magnet ratio is bound in most cases by around $1\le\lengthMag/\oradiusMag\le2$.
Secondly, as the wire diameter increases so does the coil ratio in an approximately linear relationship.
The implication of this trend is that as the wire resistance per unit length decreases and the total length of wire increases (requiring more turns), it is advantageous to extend the length of the coil rather than to extend its outer radius.
As shown in \figref{magcoil-ratiomax-norm}, however, as the length of the coil exceeds the magnet length significantly, the normalised amount of force produced quickly decreases; driving the coil with a larger current is the only way to achieve parity with the shorter coils with smaller wire diameter.

\begin{figure}
\begin{wide}
\subfloat[Optimal values of magnet ratio $\ratioMag$.]{\psfragfig{magcode/examples/fig/magcoil-ratiomax-a}}\hfill
\subfloat[Optimal values of coil ratio $\ratioCoil$.]{\psfragfig{magcode/examples/fig/magcoil-ratiomax-b}}
\end{wide}
\caption
[Optimal values of magnet ratio and coil ratio.]
{Optimal values found of the magnet and coil ratios at each value of wire diameter investigated, corresponding to the results shown in \figref{magcoil-ratiomax-comb}.}
\figlabel{magcoil-ratiomax-ratios}
\end{figure}

\subsection{Effects of magnet volume and coil resistance}

Finally, while the results from \figref{magcoil-ratiomax} indicate that increasing the coil resistance will lead to an increased maximum peak force for a given magnet volume, this increase provides diminishing returns as the resistance increases past a certain point.
This is shown in \figref{magcoil-resistance} as a plot of maximum peak force versus coil resistance over a range of magnet volumes according to the function
\begin{dmath}
\fmax\fn{\volMag,\resistanceCoil} = \max_{\diamWire} \biggl\{\fmax\fn{\volMag,\resistanceCoil,\diamWire,\safetyFactor}\biggr\}
\end{dmath},
using a safety factor of $\safetyFactor=20\%$ on the maximum current to accommodate unmodelled thermal effects.

Qualitatively, this diminishing return in the maximum peak force can be explained by the fact that the larger the total coil resistance the longer the length of wire needed and the less compact the coil can be, resulting in a movement of the magnet field away from the permanent magnet.
Therefore, despite the larger electrical energy input, this can only be achieved with a less efficient geometric design of the electromagnetic system.
As added disadvantages to increasing the force in this way, the larger the resistance the greater the electrical power required to drive the coil at a certain current, the more windings required to construct the coil, and the greater the chance of thermal difficulties with the cooling of bulkier coils.
Increasing the volume of the permanent magnet will generally be a more suitable approach to generating larger forces.

\begin{figure}
\centering
\psfragfig{magcode/examples/fig/magcoil-resistance}
\caption[Maximum peak force as a function of coil resistance over a range of magnet volumes.]{Maximum peak force as a function of coil resistance over a range of magnet volumes, showing that an increase in coil resistance leads to diminishing returns in peak force.
A safety factor of 20\% on the maximum current has been applied to obtain these results.}
\figlabel{magcoil-resistance}
\end{figure}

The overall outcome of this modelling is to conclude that after choosing a magnet volume and coil impedance, it is possible to optimise the force--displacement characteristic according to some cost function to choose the wire diameter, magnet shape, and number of coil turns.
Designing a device to achieve a certain peak force, say, then requires simply choosing an appropriate magnet size and coil impedance, both of which depend on additional considerations including cost, availability of suitable amplifier specifications, requirements for compact design, and so on.

\subsection{Summary}

In this section the theory has been summarised and compared for analytically calculating the force generated between a thick coil of varying dimensions and a cylindrical permanent magnet with relative displacement in the axial direction.
Despite the integral equation for this system being solved by other researchers almost entirely analytically, in some cases such a solution is computationally more expensive than numerical integration.
An alternative solution using iteration over `shells' of infinitely thin surface current densities is computationally cheaper again for coils with a relatively small number of radial turns.

This theory is suitable for optimising a wide range of actuator designs and in particular the general case of designing a magnetic actuator for peak force has been shown to reduce to choosing a coil impedance and magnet volume from which all geometric parameters are implicitly calculated.
This design methodology can also be used to optimise the system parameters using other cost functions such as stroke length or linearity.








\section{Dual-coil electromagnet design}
\seclabel{dualcoil}

Considering the force equation between a magnet and coil (\eqref{magcoil-integral}, and other methods), the constant term $\turnsCoil\currentCoil/\gp{\oradiusCoil-\iradiusCoil}$ is the cause of some subtle considerations when designing electromagnetic actuators.
The force created by a single layer coil (that is, $\turnsRCoil=1$) cannot be improved upon for a fixed input power by adding more layers radially, because the total length of wire (and hence the resistance, and the inverse of current) will grow faster than the linear gains achieved in the force.

The study in \secref{magnetcoil-optimisation} has outlined an optimisation technique to achieve the maximum peak force given a fixed magnet volume and input resistance.
This peak force can be subsequently improved upon by using a different coil design.
By wiring two half-resistance coils in series and in opposite winding directions, with the permanent magnet in the gap between them (\figref{dual-coil-schematic}), greater forces can be achieved than with a single coil of equivalent resistance.
This design is also better at dissipating heat, as the effective surface area is greater.

\begin{figure}
  \begin{wide}
  \subbottom[Schematic of the system.\figlabel{dual-coil-schematic}]{%
  \asyinclude{\jobname/dual-coil}
  }
  \hfil
  \subbottom[Example dual-coil forces (dashed) against an equivalent single coil system (solid).
    \figlabel{dual-coil-plot}]{%
  \psfragfig{PhD/Simulations/Coil/fig/dual-coil}}
  \end{wide}
  \caption{Electromagnet system with dual push/pull coils.}
  \figlabel{dual-coil}
\end{figure}

For two coaxial coils with a distance $\coilDualGap$ between their centres, superposition can be used to calculate the forces ${\forceThickCoil}_1$ and ${\forceThickCoil}_2$ generated between each and a permanent magnet free to move between them.
The axial distance between the permanent magnet and the two coils is denoted by
$\dispaxial_1$ and $\gp{-\coilDualGap+\dispaxial_1}$.
The total axial force on the magnet is given by
\begin{dmath}[compact]
{\forceThickCoil}_{\mathrm{T}}\fn{\dispaxial_1,\coilDualGap}
  ={\forceThickCoil}_1\fn{\dispaxial_1}+{\forceThickCoil}_2\fn{-\coilDualGap+\dispaxial_1}
\end{dmath}.
The two coils are assumed to be the same size.
For a fixed dual-coil geometry, this equation allows an investigation of the force \vs\ displacement curves while varying the distance between the coils and the position of the permanent magnet.

The improvement that can be achieved with the dual-coil design is demonstrated via an example.
The results from the previous optimisation for coil and magnet aspect ratios (\figref{magcoil-ratiomax-ratios}) indicate that generally a longer coil than magnet produces larger forces (\ie, a larger coil aspect ratio).
In such cases, the maximum force experienced by the permanent magnet is seen at a displacement of half the coil length.
The dual-coil spacing $\coilDualGap$ should be chosen such that the displacement for peak force aligns for both coils so as to achieve maximum force from both coils; for the case of longer coils than magnets, this spacing becomes equal to the coil length.
In other words, there is zero gap between adjacent coils.
When the separation distance is larger than this, a long stroke actuator can be designed with such a setup by sacrificing maximum force to achieve a wider but lower force peak.

These ideas are shown by example in \figref{dual-coil}, which shows a dual-coil design with varying coil gap $\coilDualGap$.
Simulation parameters for this example are shown in \tabref{dual-coil-parameters}; note in the dual-coil design, the outer radius of the coil is the only difference, corresponding to fewer radial turns to achieve half the coil resistance.
The dual-coil design can achieve over 50\% greater peak force than the equivalent resistance single coil design; even when some additional gap is added (such as the $\coilDualGap=\SI{80}{mm}$ case), the peak force is still larger but the stroke length is greatly improved.
As the coils are separated further, they exhibit a `double peak' characteristic (shown for $\coilDualGap=\SI{90}{mm}$) which essentially bounds the coil gap where the dual-coil design is advantageous over having a single coil alone.
Larger improvement to the forces could be achieved by optimising the shapes of each separate coil in the dual-coil arrangement rather than taking the coil aspect ratio from the original single-coil design.

\begin{table}
\lofcaption
  {
    Explicit and implicit parameters for the dual-coil example.}
  { The dual-coil system has twin coils of half resistance.}
\tablabel{dual-coil-parameters}
\begin{tabular}{@{}lclc@{}}
\toprule
\multicolumn{2}{@{}c@{}}{Explicit} & \multicolumn{2}{@{}c@{}}{Implicit} \\
\cmidrule(r){1-2}
\cmidrule(l){3-4}
Magnet ratio & \num{2} & Magnet length & \SI{21.7}{mm} \\
Coil ratio & \num{5} & Magnet radius & \SI{10.8}{mm} \\
Wire diameter & \SI{1}{mm} & Coil inner radius   & \SI{11.8}{mm} \\
Coil resistance (single) & \SI{8}{\ohm} & Coil length   & \SI{59}{mm} \\
Magnet volume & $\gp[0]{\SI{20}{mm}}^3$ & Coil thickness (single) & \SI{34}{mm} \\
Coil current & \SI{1}{A} & Coil thickness (dual) & \SI{22}{mm} \\
Magnetisation & \SI{1}{T} \\
\bottomrule
\end{tabular}
\end{table}

\section{Summary of electromagnetic coil design}

In this chapter, theory has been developed for calculating forces between cylindrical coils and magnets; as a contribution to the literature, a much improved method has been demonstrated for calculating the force between thin coils.
The use of this equation to efficiently calculate thick-coil/magnet forces has also been detailed.
An equation has also been presented for calculating the axial force between a thick coil and permanent magnet with both axial and radial (or eccentric) displacement.

Two electromagnetic systems have been analysed.
The first was an optimisation of a `sleeve-type' electromagnetic actuator, and for this system it was shown that such analysis can yield optimal values for magnet and coil parameters.
The outcome from this study is to posit a solution to the inverse problem: given a required electromagnetic force, what magnet sizes and coil windings should be used to achieve this force with minimal space and/or cost?

Secondly, it has been shown that the single-coil system analysed in detail can be further improved by using two equivalent coils in series with half the resistance; the overall effect is to direct the magnetic field of these coils more efficiently than can be done with a single coil alone.

\end{document}

